changeMainView('<%= escape_javascript(render "welcome") %>', <%= flash.count %>,
        '<%= escape_javascript(render partial: "shared/flash_messages", flash: flash) %>');
//$("#main-content").html('<%#= escape_javascript(render "welcome") %>');
//$('#flash_messages').html('<%#= escape_javascript(render partial: "shared/flash_messages", flash: flash) %>');
$('.banner').hide();
$('.points-view').hide();
$('.footer').hide();

//$(document).on('click', '[data="submit-form"]', function(e) {
//    e.preventDefault();
//    $(this).closest('form').submit();
//    return false;
//});


$('a').not('#email-signup, #reg-with-facebook').click(function() {
    window.loadRemoteScript = false;
    History.pushState(null, '', $(this).attr("href"));
});


$('#email-signup').click(function(e) {
    window.loadRemoteScript = false;
    History.pushState({}, '', '/players/sign_up' + '?reg_code=' + $('#code-field').val());
    e.preventDefault();
    $(this).closest('form').submit();
    return false;
});

$('#reg-with-facebook').click(function(e) {
    e.preventDefault();
    var input = $("<input>")
            .attr("type", "hidden")
            .attr("name", "facebook").val("");

    $(this).closest('form').append($(input)).submit();
    return false;
});



showRegOptions();
$('#code-field').on('keyup input change', showRegOptions);
var lastValue = '';
$('#code-field').on('keyup', function() {
    if (lastValue != this.value && /[a-z]/.test(this.value)) {
        // If there's a change in string and lowercase letters has been typed
        // Change string to uper case
        this.value = this.value.toUpperCase();
    }
    lastValue = this.value;
});

function showRegOptions() {
    if ($('#code-field').val().length > 6) {
        //$('#reg-options').css('visibility', 'visible');
        $('#reg-options').show();
        //$('#reg-signin-form').css({'height': '220px', marginBottom: '0' });
    } else {
        //$('#reg-options').css('visibility', 'hidden');
        $('#reg-options').hide();
        //$('#reg-signin-form').css({'height': '190px', marginBottom: '30px' });
    }
}